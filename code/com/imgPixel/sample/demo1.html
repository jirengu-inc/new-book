<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<style>
	.letter{
		float: left;
		margin:10px;
	}
</style>
<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
	<div class="container"></div>
    

<script>
	var Pixel = (function() {
		var pixMap = {
			a: [
				[0, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			b: [
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 0]
			],
			c: [
				[0, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 1],
				[0, 1, 1, 0]
			],
			d: [
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 0]
			],
			e: [
				[1, 1, 1, 1],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 1, 1, 0],
				[1, 0, 0, 0],
				[1, 1, 1, 1]
			],
			f: [
				[1, 1, 1, 1],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 1, 1, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0]
			],
			g: [
				[0, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 0],
				[1, 0, 1, 1],
				[1, 0, 0, 1],
				[0, 1, 1, 0]
			],
			h: [
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			i: [
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0]
			],
			j: [
				[0, 0, 1, 1],
				[0, 0, 0, 1],
				[0, 0, 0, 1],
				[0, 0, 0, 1],
				[1, 0, 0, 1],
				[0, 1, 1, 0]
			],
			k: [
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			l: [
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0],
				[1, 1, 1, 1]
			],
			m: [
				[1, 0, 0, 0, 1],
				[1, 1, 0, 1, 1],
				[1, 0, 1, 0, 1],
				[1, 0, 0, 0, 1],
				[1, 0, 0, 0, 1],
				[1, 0, 0, 0, 1]
			],
			n: [
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 0, 1],
				[1, 0, 1, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			o: [
				[0, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[0, 1, 1, 0]
			],
			p: [
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 0],
				[1, 0, 0, 0],
				[1, 0, 0, 0]
			],
			q: [
				[0, 1, 1, 0, 0],
				[1, 0, 0, 1, 0],
				[1, 0, 0, 1, 0],
				[1, 0, 0, 1, 0],
				[1, 0, 0, 1, 0],
				[0, 1, 1, 0, 1]
			],
			r: [
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			s: [
				[0, 1, 1, 1],
				[1, 0, 0, 0],
				[0, 1, 0, 0],
				[0, 0, 1, 0],
				[0, 0, 0, 1],
				[1, 1, 1, 0]
			],
			t: [
				[1, 1, 1, 1, 1],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0]
			],
			u: [
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[0, 1, 1, 0]
			],
			v: [
				[1, 0, 0, 0, 1],
				[1, 0, 0, 0, 1],
				[0, 1, 0, 1, 0],
				[0, 1, 0, 1, 0],
				[0, 1, 0, 1, 0],
				[0, 0, 1, 0, 0]
			],
			w: [
				[1, 0, 0, 0, 0, 0, 1],
				[1, 0, 0, 1, 0, 0, 1],
				[1, 0, 0, 1, 0, 0, 1],
				[1, 0, 0, 1, 0, 0, 1],
				[1, 0, 0, 1, 0, 0, 1],
				[0, 1, 1, 0, 1, 1, 0]
			],
			x: [
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[1, 0, 0, 1],
				[0, 1, 1, 0],
				[1, 0, 0, 1],
				[1, 0, 0, 1]
			],
			y: [
				[1, 0, 0, 0, 1],
				[1, 0, 0, 0, 1],
				[0, 1, 0, 1, 0],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0],
				[0, 0, 1, 0, 0]
			],
			z: [
				[1, 1, 1, 1],
				[0, 0, 0, 1],
				[0, 0, 1, 0],
				[0, 1, 0, 0],
				[1, 0, 0, 0],
				[1, 1, 1, 1]
			],
			' ': [
				[0, 0, 0, 0],
				[0, 0, 0, 0],
				[0, 0, 0, 0],
				[0, 0, 0, 0],
				[0, 0, 0, 0],
				[0, 0, 0, 0]
			]
		};
		var defaultOpts = {
			pixelWidth: 30,
			gap: 1,
			letterCls: 'letter',
			ct: document.body,
			bgColor: '#42a44d',
			style: {
				'borderLeft': '15px solid #42a44d',
				'borderTop': '15px solid #259e47',
				'borderBottom': '15px solid #568647',
				'borderRight': '15px solid #186d31',
				'boxSizing': 'border-box'
			}
		};
		var config = {},
			pixs = [];
			imgElems = [];
		var pixNum = 0;

		function setLetterStyle(opts) {
			config = _extend({},
				defaultOpts, opts);
			if(config.imgs){
				config.imgs.sort(function(){
					return Math.random()>0.5?-1:1;
				}); 				
			}

		}

		function createLetter(ch) {
			var letter = document.createElement('div');
			
			letter.className = config.letterCls;
			var arr = pixMap[ch];
			_css(letter, {
				position: 'relative',
				height: (config.pixelWidth + config.gap) * arr.length + 'px',
				width: (config.pixelWidth + config.gap) * arr[0].length + 'px'
			});

			
			for (var row = 0; row < arr.length; row++) {
				for (var col = 0; col < arr[row].length; col++) {
					p_v = arr[row][col];
					if (p_v === 1) {
						pixNum++;

						var pix = document.createElement('span'),
							pixStyle = {
								position: 'absolute',
								top: (config.pixelWidth + config.gap) * row + 'px',
								left: (config.pixelWidth + config.gap) * col + 'px',
								display: 'block',
								width: config.pixelWidth+ 'px',
								height: config.pixelWidth+ 'px',
								background: config.bgColor,
								overflow: 'hidden'

							},
							finalStyle = {};


						if(config.imgs){
							var imgCount = config.imgs.length;
							var img = document.createElement('img');
							img.className = 'pix-img';
							img.setAttribute('data-src', config.imgs[pixNum%imgCount]);
							pix.appendChild(img);
							imgElems.push(img);
							_extend(finalStyle, pixStyle);
						}else{
							_extend(finalStyle, pixStyle, config.style || {});
						}

						if(config.fade){
							finalStyle.opacity = 0;
						}
						_css(pix, finalStyle);
						letter.appendChild(pix);
						pixs.push(pix);
					}
				}
			}

			return letter;
		}

		function createWord(str, opts) {
			setLetterStyle(opts || {});
			var chs = str.split('');
			for (var i = 0; i < chs.length; i++) {
				var letter = createLetter(chs[i].toLowerCase());
				config.ct.appendChild(letter);
			}
			if(config.fade){
				var randArr = getRandArray(pixs.length);
				for(var j = 0; j< randArr.length; j++){
					(function(n){
						setTimeout(function(){
							unfade(pixs[randArr[n]]);
						}, n*30);
						
					})(j);
				}
			}
		}

		function createImgWord(str, opts){
			createWord(str, opts);
			var randArr = getRandArray(imgElems.length);

			for(var i = 0; i<randArr.length; i++){
				(function(idx){
					setTimeout(function(){
						var pix = pixs[randArr[idx]],
							img = imgElems[randArr[idx]];
						fade(pix, function(){
							img.setAttribute('src', img.getAttribute('data-src'));
						});
						
						img.onload = function(){
							var w = this.width,
								h = this.height;
							if(w < h){
								_css(this,{width: config.pixelWidth+'px', marginTop: ((w-h)/2)*(config.pixelWidth/w)+'px' });
							}else{
								_css(this,{height: config.pixelWidth+'px', marginLeft: ((h-w)/2)*(config.pixelWidth/h)+'px'});
							}
							unfade(this.parentElement);
						}
					}, 10*idx+imgElems.length*30 +1000)	
				})(i)
			}
		}


		function _extend(target, src1, src2) {
			if (arguments.length < 2) return target;
			var src;
			for (var i = 1; i < arguments.length; i++) {
				src = arguments[i];
				for (var key in src) {
					target[key] = src[key];
				}
			}
			return target;
		}

		function _css(elem, opts) {
			for (var attr in opts) {
				elem.style[attr] = opts[attr];
			}
		}
		function fade(element, cb) {
		    var op = 1;  // initial opacity
		    var timer = setInterval(function () {
		        if (op <= 0.1){
		            clearInterval(timer);
		            element.style.display = 'none';
		            cb && cb();
		        }
		        element.style.opacity = op;
		        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
		        op -= op * 0.1;
		    }, 10);
		}
		function unfade(element, cb) {
		    var op = 0.1;  // initial opacity
		    element.style.display = 'block';
		    var timer = setInterval(function () {
		        if (op >= 1){
		            clearInterval(timer);
		            cb && cb();
		        }
		        element.style.opacity = op;
		        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
		        op += op * 0.1;
		    }, 10);
		}
		function getRandArray(len){
			var arr = [];
			for(var i=0;i<len;i++){
				arr.push(i);
			}
			arr.sort(function(){
				return Math.random()>0.5?-1:1;
			}); 
			return arr;
		}

		return {
			createWord: createWord,
			createImgWord: createImgWord
		};
	})();


	// Pixel.createWord('hunger valley' );
	// Pixel.createWord('hello world', {
	// 	ct: document.getElementsByClassName('container')[0],
	// 	pixelWidth: 10,
	// 	pixelWidth: 10,
	// 	style: {
	// 		background: 'red'
	// 	}
	// });

	var imgs = [];
	for(var i=0;i<34; i++){
		if(i==14)
			continue;
		imgs.push('img/'+i+'.jpg');
	}
	Pixel.createImgWord('hUnger', {
		pixelWidth: 30,
		bgColor: '#1bca87',
		fade: true,
		imgs: imgs
	});

</script>    
</body>
</html>